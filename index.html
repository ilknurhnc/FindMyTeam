<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find My Team</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="src/style.css">
</head>
<body>
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h3>Spor Arkada≈üƒ± Y√ºkleniyor...</h3>
        </div>
    </div>

    <div class="bg-animation">
        <div class="floating-shape"></div>
        <div class="floating-shape"></div>
        <div class="floating-shape"></div>
        <div class="floating-shape"></div>
    </div>

    <div id="app"></div>

    <script>
        // API URL (Backend baƒülantƒ±sƒ± i√ßin)
        const API_URL = 'https://localhost:7001/api';

        // Sayfa ≈üablonlarƒ±
        const pages = {
            login: `
                <div class="auth-container">
                    <div class="auth-box glass">
                        <div class="auth-avatar">
                            <i class="fas fa-running"></i>
                        </div>
                        <div class="auth-tabs" id="authTabs">
                            <button class="tab-btn active" data-tab="login">
                                <i class="fas fa-sign-in-alt"></i> Giri≈ü Yap
                            </button>
                            <button class="tab-btn" data-tab="register">
                                <i class="fas fa-user-plus"></i> Kayƒ±t Ol
                            </button>
                        </div>
                        <form id="loginForm">
                            <div class="form-group">
                                <input type="email" class="form-input" placeholder="‚úâÔ∏è E-posta adresiniz" required>
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-input" placeholder="üîí ≈ûifreniz" required>
                            </div>
                            <button type="submit" class="submit-btn">
                                <span class="btn-text">
                                    <i class="fas fa-sign-in-alt"></i> Giri≈ü Yap
                                </span>
                            </button>
                        </form>
                    </div>
                </div>
            `,

            register: `
                <div class="auth-container">
                    <div class="auth-box glass">
                        <div class="auth-avatar">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <div class="auth-tabs register-active" id="authTabs">
                            <button class="tab-btn" data-tab="login">
                                <i class="fas fa-sign-in-alt"></i> Giri≈ü Yap
                            </button>
                            <button class="tab-btn active" data-tab="register">
                                <i class="fas fa-user-plus"></i> Kayƒ±t Ol
                            </button>
                        </div>
                        <form id="registerForm">
                            <div class="form-group">
                                <input type="text" class="form-input" placeholder="üë§ Ad Soyad" required>
                            </div>
                            <div class="form-group">
                                <input type="email" class="form-input" placeholder="‚úâÔ∏è E-posta adresiniz" required>
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-input" placeholder="üîí ≈ûifre" required>
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-input" placeholder="üîí ≈ûifre Tekrar" required>
                            </div>
                            <button type="submit" class="submit-btn">
                                <span class="btn-text">
                                    <i class="fas fa-user-plus"></i> Kayƒ±t Ol
                                </span>
                            </button>
                        </form>
                    </div>
                </div>
            `,

            home: `
                <header class="app-header">
                    <div class="header-content">
                        <a href="#" class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <span>Spor Arkada≈üƒ±</span>
                        </a>
                        <nav class="nav-menu">
                            <button class="nav-btn active" data-page="home">
                                <i class="fas fa-home"></i> Ana Sayfa
                            </button>
                            <button class="nav-btn" data-page="create">
                                <i class="fas fa-plus-circle"></i> Etkinlik Olu≈ütur
                            </button>
                            <button class="nav-btn" data-page="map">
                                <i class="fas fa-map-marker-alt"></i> Harita
                            </button>
                            <button class="nav-btn" data-page="profile">
                                <i class="fas fa-user"></i> Profil
                            </button>
                            <button class="nav-btn logout-btn">
                                <i class="fas fa-sign-out-alt"></i> √áƒ±kƒ±≈ü
                            </button>
                        </nav>
                    </div>
                </header>
                
                <main class="main-content">
                    <section class="hero">
                        <h1><i class="fas fa-fire"></i> Find My Team!</h1>
                        <p>√áevrendeki sporcularla tanƒ±≈ü, etkinliklere katƒ±l ve aktif ya≈üamƒ±nƒ±n tadƒ±nƒ± √ßƒ±kar!</p>
                        <div class="hero-stats">
                            <div class="stat-item">
                                <span class="stat-number" id="activeEvents">0</span>
                                <span class="stat-label">Aktif Etkinlik</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="totalUsers">0</span>
                                <span class="stat-label">Kayƒ±tlƒ± Kullanƒ±cƒ±</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="sportsCount">8</span>
                                <span class="stat-label">Spor Dalƒ±</span>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h2 class="section-title">üî• Pop√ºler Etkinlikler</h2>
                        <div class="events-grid" id="eventsGrid">
                            <!-- Etkinlikler buraya y√ºklenecek -->
                        </div>
                    </section>
                </main>
            `,

            create: `
                <header class="app-header">
                    <div class="header-content">
                        <a href="#" class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <span>Spor Arkada≈üƒ±</span>
                        </a>
                        <nav class="nav-menu">
                            <button class="nav-btn" data-page="home">
                                <i class="fas fa-home"></i> Ana Sayfa
                            </button>
                            <button class="nav-btn active" data-page="create">
                                <i class="fas fa-plus-circle"></i> Etkinlik Olu≈ütur
                            </button>
                            <button class="nav-btn" data-page="map">
                                <i class="fas fa-map-marker-alt"></i> Harita
                            </button>
                            <button class="nav-btn" data-page="profile">
                                <i class="fas fa-user"></i> Profil
                            </button>
                            <button class="nav-btn logout-btn">
                                <i class="fas fa-sign-out-alt"></i> √áƒ±kƒ±≈ü
                            </button>
                        </nav>
                    </div>
                </header>
                
                <main class="main-content">
                    <section>
                        <h2 class="section-title"><i class="fas fa-magic"></i> Yeni Etkinlik Olu≈ütur</h2>
                        <div class="create-form">
                            <form id="createEventForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <select class="form-select" name="sportType" required>
                                            <option value="">üèÉ‚Äç‚ôÇÔ∏è Spor T√ºr√º Se√ßin</option>
                                            <option value="football">‚öΩ Futbol</option>
                                            <option value="basketball">üèÄ Basketbol</option>
                                            <option value="volleyball">üèê Voleybol</option>
                                            <option value="tennis">üéæ Tenis</option>
                                            <option value="running">üèÉ‚Äç‚ôÇÔ∏è Ko≈üu</option>
                                            <option value="cycling">üö¥‚Äç‚ôÇÔ∏è Bisiklet</option>
                                            <option value="swimming">üèä‚Äç‚ôÇÔ∏è Y√ºzme</option>
                                            <option value="badminton">üè∏ Badminton</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" class="form-input" name="title" placeholder="üèÜ Etkinlik Adƒ±" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="text" class="form-input" name="location" placeholder="üìç Konum (√∂rn: Atat√ºrk Parkƒ±)" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="datetime-local" class="form-input" name="eventDate" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="number" class="form-input" name="maxParticipants" placeholder="üë• Maksimum Katƒ±lƒ±mcƒ±" min="2" max="50" required>
                                    </div>
                                    <div class="form-group">
                                        <select class="form-select" name="skillLevel" required>
                                            <option value="">üìä Seviye Se√ßin</option>
                                            <option value="beginner">üå± Ba≈ülangƒ±√ß</option>
                                            <option value="intermediate">‚≠ê Orta</option>
                                            <option value="advanced">üèÜ ƒ∞leri</option>
                                            <option value="mixed">üéØ Karma</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <textarea class="form-textarea" name="description" placeholder="üìù Etkinlik a√ßƒ±klamasƒ± (isteƒüe baƒülƒ±)"></textarea>
                                </div>
                                
                                <button type="submit" class="submit-btn">
                                    <span class="btn-text">
                                        <i class="fas fa-rocket"></i> Etkinliƒüi Olu≈ütur
                                    </span>
                                </button>
                            </form>
                        </div>
                    </section>
                </main>
            `,

            map: `
                <header class="app-header">
                    <div class="header-content">
                        <a href="#" class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <span>Spor Arkada≈üƒ±</span>
                        </a>
                        <nav class="nav-menu">
                            <button class="nav-btn" data-page="home">
                                <i class="fas fa-home"></i> Ana Sayfa
                            </button>
                            <button class="nav-btn" data-page="create">
                                <i class="fas fa-plus-circle"></i> Etkinlik Olu≈ütur
                            </button>
                            <button class="nav-btn active" data-page="map">
                                <i class="fas fa-map-marker-alt"></i> Harita
                            </button>
                            <button class="nav-btn" data-page="profile">
                                <i class="fas fa-user"></i> Profil
                            </button>
                            <button class="nav-btn logout-btn">
                                <i class="fas fa-sign-out-alt"></i> √áƒ±kƒ±≈ü
                            </button>
                        </nav>
                    </div>
                </header>
                
                <main class="main-content">
                    <section>
                        <h2 class="section-title"><i class="fas fa-globe-americas"></i> Etkinlik Haritasƒ±</h2>
                        <div class="map-container">
                            <div class="map-placeholder">
                                <i class="fas fa-map-marked-alt"></i>
                                <h3>Harita Entegrasyonu</h3>
                                <p>Google Maps API ile etkinlikleri harita √ºzerinde g√∂r√ºnt√ºleyebileceksiniz.</p>
                                <p>Yakƒ±nda aktif olacak!</p>
                            </div>
                        </div>
                    </section>
                </main>
            `,

            profile: `
                <header class="app-header">
                    <div class="header-content">
                        <a href="#" class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <span>Spor Arkada≈üƒ±</span>
                        </a>
                        <nav class="nav-menu">
                            <button class="nav-btn" data-page="home">
                                <i class="fas fa-home"></i> Ana Sayfa
                            </button>
                            <button class="nav-btn" data-page="create">
                                <i class="fas fa-plus-circle"></i> Etkinlik Olu≈ütur
                            </button>
                            <button class="nav-btn" data-page="map">
                                <i class="fas fa-map-marker-alt"></i> Harita
                            </button>
                            <button class="nav-btn active" data-page="profile">
                                <i class="fas fa-user"></i> Profil
                            </button>
                            <button class="nav-btn logout-btn">
                                <i class="fas fa-sign-out-alt"></i> √áƒ±kƒ±≈ü
                            </button>
                        </nav>
                    </div>
                </header>
                
                <main class="main-content">
                    <div class="profile-container">
                        <section class="profile-header">
                            <div class="profile-avatar">
                                <i class="fas fa-user-athlete"></i>
                            </div>
                            <h2 class="profile-name" id="profileName">Kullanƒ±cƒ±</h2>
                            <p class="profile-email" id="profileEmail">email@example.com</p>
                        </section>

                        <section>
                            <h2 class="section-title"><i class="fas fa-chart-line"></i> ƒ∞statistiklerim</h2>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-calendar-check"></i>
                                    </div>
                                    <div class="stat-value" id="joinedEvents">0</div>
                                    <div class="stat-description">Katƒ±ldƒ±ƒüƒ±m Etkinlik</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-plus-circle"></i>
                                    </div>
                                    <div class="stat-value" id="createdEvents">0</div>
                                    <div class="stat-description">Olu≈üturduƒüum Etkinlik</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <div class="stat-value" id="completedEvents">0</div>
                                    <div class="stat-description">Tamamlanan Etkinlik</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <div class="stat-value" id="sportFriends">0</div>
                                    <div class="stat-description">Spor Arkada≈üƒ±</div>
                                </div>
                            </div>
                        </section>
                    </div>
                </main>
            `
        };

        // Uygulama durumu
        let currentUser = null;
        let events = [];

        // Spor ikonu mapping
        const sportIcons = {
            football: '‚öΩ',
            basketball: 'üèÄ',
            volleyball: 'üèê',
            tennis: 'üéæ',
            running: 'üèÉ‚Äç‚ôÇÔ∏è',
            cycling: 'üö¥‚Äç‚ôÇÔ∏è',
            swimming: 'üèä‚Äç‚ôÇÔ∏è',
            badminton: 'üè∏'
        };

        // Seviye mapping
        const skillLevels = {
            beginner: 'üå± Ba≈ülangƒ±√ß',
            intermediate: '‚≠ê Orta',
            advanced: 'üèÜ ƒ∞leri',
            mixed: 'üéØ Karma'
        };

        // API √ßaƒürƒ±larƒ±
        const api = {
            async login(email, password) {
                try {
                    const response = await fetch(`${API_URL}/auth/login`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ email, password })
                    });
                    
                    if (!response.ok) {
                        throw new Error('Giri≈ü ba≈üarƒ±sƒ±z');
                    }
                    
                    return await response.json();
                } catch (error) {
                    // Ge√ßici olarak mock data d√∂nd√ºr
                    return {
                        success: true,
                        user: {
                            id: 1,
                            name: 'Ahmet Yƒ±lmaz',
                            email: email
                        },
                        token: 'mock-token'
                    };
                }
            },

            async register(userData) {
                try {
                    const response = await fetch(`${API_URL}/auth/register`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(userData)
                    });
                    
                    if (!response.ok) {
                        throw new Error('Kayƒ±t ba≈üarƒ±sƒ±z');
                    }
                    
                    return await response.json();
                } catch (error) {
                    // Ge√ßici olarak mock data d√∂nd√ºr
                    return {
                        success: true,
                        message: 'Kayƒ±t ba≈üarƒ±lƒ±'
                    };
                }
            },

            async getEvents() {
                try {
                    const response = await fetch(`${API_URL}/events`);
                    if (!response.ok) {
                        throw new Error('Etkinlikler y√ºklenemedi');
                    }
                    return await response.json();
                } catch (error) {
                    // Mock events data
                    return [
                        {
                            id: 1,
                            title: '5vs5 Futbol Ma√ßƒ±',
                            sportType: 'football',
                            location: 'Atat√ºrk Parkƒ±',
                            eventDate: new Date(Date.now() + 2 * 60 * 60 * 1000).toISOString(),
                            maxParticipants: 10,
                            currentParticipants: 6,
                            skillLevel: 'intermediate',
                            description: 'Eƒülenceli futbol ma√ßƒ± i√ßin katƒ±lƒ±mcƒ±lar bekliyoruz!',
                            creatorName: 'Mehmet √ñzkan'
                        },
                        {
                            id: 2,
                            title: 'Basketbol Turnuvasƒ±',
                            sportType: 'basketball',
                            location: 'Spor Salonu',
                            eventDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
                            maxParticipants: 8,
                            currentParticipants: 4,
                            skillLevel: 'advanced',
                            description: 'Basketbol severler i√ßin turnuva organizasyonu',
                            creatorName: 'Ay≈üe Demir'
                        },
                        {
                            id: 3,
                            title: 'Tenis Partneri Arƒ±yorum',
                            sportType: 'tennis',
                            location: 'Tenis Kul√ºb√º',
                            eventDate: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString(),
                            maxParticipants: 2,
                            currentParticipants: 1,
                            skillLevel: 'beginner',
                            description: 'Yeni ba≈ülayan tenis oyuncusu partner arƒ±yor',
                            creatorName: 'Ali Yƒ±ldƒ±z'
                        },
                        {
                            id: 4,
                            title: 'Sabah Ko≈üusu Grubu',
                            sportType: 'running',
                            location: 'Ma√ßka Parkƒ±',
                            eventDate: new Date(Date.now() + 12 * 60 * 60 * 1000).toISOString(),
                            maxParticipants: 15,
                            currentParticipants: 8,
                            skillLevel: 'mixed',
                            description: 'Her seviyeden ko≈üucu ho≈ü geldin!',
                            creatorName: 'Fatma Kaya'
                        }
                    ];
                }
            },

            async createEvent(eventData) {
                try {
                    const response = await fetch(`${API_URL}/events`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${localStorage.getItem('token')}`
                        },
                        body: JSON.stringify(eventData)
                    });
                    
                    if (!response.ok) {
                        throw new Error('Etkinlik olu≈üturulamadƒ±');
                    }
                    
                    return await response.json();
                } catch (error) {
                    // Mock success
                    return {
                        success: true,
                        message: 'Etkinlik ba≈üarƒ±yla olu≈üturuldu',
                        event: { id: Date.now(), ...eventData }
                    };
                }
            },

            async joinEvent(eventId) {
                try {
                    const response = await fetch(`${API_URL}/events/${eventId}/join`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('token')}`
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error('Etkinliƒüe katƒ±lƒ±namadƒ±');
                    }
                    
                    return await response.json();
                } catch (error) {
                    // Mock success
                    return {
                        success: true,
                        message: 'Etkinliƒüe ba≈üarƒ±yla katƒ±ldƒ±nƒ±z'
                    };
                }
            }
        };

        // Bildirim sistemi
        function showNotification(message, type = 'success') {
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();

            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-triangle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        // Loading ekranƒ±
        function hideLoadingScreen() {
            const loadingScreen = document.getElementById('loadingScreen');
            setTimeout(() => {
                loadingScreen.classList.add('hidden');
                setTimeout(() => loadingScreen.remove(), 500);
            }, 1000);
        }

        // Sayfa navigasyonu
        function navigateTo(page) {
            const app = document.getElementById('app');
            
            if (!currentUser && !['login', 'register'].includes(page)) {
                page = 'login';
            }
            
            app.innerHTML = pages[page] || pages.login;
            setupPageEvents(page);
            window.location.hash = page;
        }

        // Sayfa event'leri
        function setupPageEvents(page) {
            switch(page) {
                case 'login':
                    setupAuthEvents();
                    break;
                case 'register':
                    setupAuthEvents();
                    break;
                case 'home':
                    setupHomeEvents();
                    loadEvents();
                    break;
                case 'create':
                    setupCreateEvents();
                    break;
                case 'profile':
                    setupProfileEvents();
                    break;
            }
            
            setupNavigationEvents();
        }

        // Auth sayfasƒ± event'leri
        function setupAuthEvents() {
            // Tab switching
            document.querySelectorAll('[data-tab]').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    navigateTo(e.target.dataset.tab);
                });
            });

            // Login form
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const submitBtn = loginForm.querySelector('button[type="submit"]');
                    submitBtn.classList.add('btn-loading');
                    
                    const formData = new FormData(loginForm);
                    const email = formData.get('email') || loginForm.querySelector('input[type="email"]').value;
                    const password = formData.get('password') || loginForm.querySelector('input[type="password"]').value;
                    
                    try {
                        const response = await api.login(email, password);
                        
                        if (response.success) {
                            currentUser = response.user;
                            localStorage.setItem('token', response.token);
                            localStorage.setItem('user', JSON.stringify(response.user));
                            
                            showNotification('üéâ Ho≈ü geldiniz! Giri≈ü ba≈üarƒ±lƒ±.');
                            setTimeout(() => navigateTo('home'), 1000);
                        }
                    } catch (error) {
                        showNotification('‚ùå Giri≈ü yapƒ±lamadƒ±. L√ºtfen bilgilerinizi kontrol edin.', 'error');
                    } finally {
                        submitBtn.classList.remove('btn-loading');
                    }
                });
            }

            // Register form
            const registerForm = document.getElementById('registerForm');
            if (registerForm) {
                registerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const submitBtn = registerForm.querySelector('button[type="submit"]');
                    const inputs = registerForm.querySelectorAll('input');
                    const passwords = registerForm.querySelectorAll('input[type="password"]');
                    
                    // ≈ûifre kontrol√º
                    if (passwords[0].value !== passwords[1].value) {
                        showNotification('‚ùå ≈ûifreler e≈üle≈ümiyor!', 'error');
                        return;
                    }
                    
                    if (passwords[0].value.length < 6) {
                        showNotification('‚ùå ≈ûifre en az 6 karakter olmalƒ±!', 'error');
                        return;
                    }
                    
                    submitBtn.classList.add('btn-loading');
                    
                    const userData = {
                        name: inputs[0].value,
                        email: inputs[1].value,
                        password: inputs[2].value
                    };
                    
                    try {
                        const response = await api.register(userData);
                        
                        if (response.success) {
                            showNotification('‚úÖ Kayƒ±t ba≈üarƒ±lƒ±! ≈ûimdi giri≈ü yapabilirsiniz.');
                            setTimeout(() => navigateTo('login'), 1500);
                        }
                    } catch (error) {
                        showNotification('‚ùå Kayƒ±t i≈ülemi ba≈üarƒ±sƒ±z. L√ºtfen tekrar deneyin.', 'error');
                    } finally {
                        submitBtn.classList.remove('btn-loading');
                    }
                });
            }
        }

        // Ana sayfa event'leri
        function setupHomeEvents() {
            // ƒ∞statistikleri g√ºncelle
            setTimeout(() => {
                document.getElementById('activeEvents').textContent = '12';
                document.getElementById('totalUsers').textContent = '247';
            }, 1000);
        }

        // Etkinlikleri y√ºkle
        async function loadEvents() {
            try {
                events = await api.getEvents();
                renderEvents(events);
            } catch (error) {
                showNotification('‚ùå Etkinlikler y√ºklenemedi.', 'error');
            }
        }

        // Etkinlikleri render et
        function renderEvents(eventsData) {
            const eventsGrid = document.getElementById('eventsGrid');
            if (!eventsGrid) return;

            eventsGrid.innerHTML = eventsData.map(event => {
                const eventDate = new Date(event.eventDate);
                const formattedDate = eventDate.toLocaleDateString('tr-TR', {
                    day: 'numeric',
                    month: 'long',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                return `
                    <div class="event-card" data-event-id="${event.id}">
                        <div class="event-header">
                            <div class="event-icon">
                                ${sportIcons[event.sportType] || 'üèÉ‚Äç‚ôÇÔ∏è'}
                            </div>
                            <h3 class="event-title">${event.title}</h3>
                        </div>
                        
                        <div class="event-details">
                            <div class="event-detail">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${event.location}</span>
                            </div>
                            <div class="event-detail">
                                <i class="fas fa-clock"></i>
                                <span>${formattedDate}</span>
                            </div>
                            <div class="event-detail">
                                <i class="fas fa-users"></i>
                                <span>${event.currentParticipants}/${event.maxParticipants} ki≈üi</span>
                            </div>
                            <div class="event-detail">
                                <i class="fas fa-chart-bar"></i>
                                <span>${skillLevels[event.skillLevel]}</span>
                            </div>
                            <div class="event-detail">
                                <i class="fas fa-user-circle"></i>
                                <span>Organizat√∂r: ${event.creatorName}</span>
                            </div>
                        </div>
                        
                        <div class="event-actions">
                            <button class="action-btn join-btn" onclick="joinEvent(${event.id})">
                                <i class="fas fa-hand-rock"></i> Katƒ±l
                            </button>
                            <button class="action-btn details-btn" onclick="showEventDetails(${event.id})">
                                <i class="fas fa-info-circle"></i> Detay
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Etkinliƒüe katƒ±l
        async function joinEvent(eventId) {
            try {
                const response = await api.joinEvent(eventId);
                if (response.success) {
                    showNotification('üéâ Etkinliƒüe ba≈üarƒ±yla katƒ±ldƒ±nƒ±z!');
                    // UI g√ºncelle
                    const eventCard = document.querySelector(`[data-event-id="${eventId}"]`);
                    const joinBtn = eventCard.querySelector('.join-btn');
                    joinBtn.innerHTML = '<i class="fas fa-times"></i> Ayrƒ±l';
                    joinBtn.classList.add('joined');
                    joinBtn.onclick = () => leaveEvent(eventId);
                }
            } catch (error) {
                showNotification('‚ùå Etkinliƒüe katƒ±lƒ±namadƒ±.', 'error');
            }
        }

        // Etkinlikten ayrƒ±l
        async function leaveEvent(eventId) {
            try {
                showNotification('üëã Etkinlikten ayrƒ±ldƒ±nƒ±z.');
                // UI g√ºncelle
                const eventCard = document.querySelector(`[data-event-id="${eventId}"]`);
                const joinBtn = eventCard.querySelector('.join-btn');
                joinBtn.innerHTML = '<i class="fas fa-hand-rock"></i> Katƒ±l';
                joinBtn.classList.remove('joined');
                joinBtn.onclick = () => joinEvent(eventId);
            } catch (error) {
                showNotification('‚ùå ƒ∞≈ülem ba≈üarƒ±sƒ±z.', 'error');
            }
        }

        // Etkinlik detaylarƒ±nƒ± g√∂ster
        function showEventDetails(eventId) {
            const event = events.find(e => e.id === eventId);
            if (event) {
                alert(`
Etkinlik: ${event.title}
A√ßƒ±klama: ${event.description || 'A√ßƒ±klama bulunmuyor.'}
Konum: ${event.location}
Tarih: ${new Date(event.eventDate).toLocaleString('tr-TR')}
Seviye: ${skillLevels[event.skillLevel]}
Katƒ±lƒ±mcƒ±lar: ${event.currentParticipants}/${event.maxParticipants}
Organizat√∂r: ${event.creatorName}
                `);
            }
        }

        // Etkinlik olu≈üturma event'leri
        function setupCreateEvents() {
            const createForm = document.getElementById('createEventForm');
            if (createForm) {
                createForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const submitBtn = createForm.querySelector('button[type="submit"]');
                    submitBtn.classList.add('btn-loading');
                    
                    const formData = new FormData(createForm);
                    const eventData = {
                        title: formData.get('title'),
                        sportType: formData.get('sportType'),
                        location: formData.get('location'),
                        eventDate: formData.get('eventDate'),
                        maxParticipants: parseInt(formData.get('maxParticipants')),
                        skillLevel: formData.get('skillLevel'),
                        description: formData.get('description')
                    };
                    
                    try {
                        const response = await api.createEvent(eventData);
                        
                        if (response.success) {
                            showNotification('üöÄ Etkinlik ba≈üarƒ±yla olu≈üturuldu!');
                            setTimeout(() => navigateTo('home'), 1500);
                        }
                    } catch (error) {
                        showNotification('‚ùå Etkinlik olu≈üturulamadƒ±.', 'error');
                    } finally {
                        submitBtn.classList.remove('btn-loading');
                    }
                });
            }
        }

        // Profil event'leri
        function setupProfileEvents() {
            if (currentUser) {
                document.getElementById('profileName').textContent = currentUser.name;
                document.getElementById('profileEmail').textContent = currentUser.email;
                
                // Mock istatistikler
                setTimeout(() => {
                    document.getElementById('joinedEvents').textContent = '5';
                    document.getElementById('createdEvents').textContent = '2';
                    document.getElementById('completedEvents').textContent = '3';
                    document.getElementById('sportFriends').textContent = '12';
                }, 500);
            }
        }

        // Navigation event'leri
        function setupNavigationEvents() {
            // Nav button'larƒ±
            document.querySelectorAll('[data-page]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const page = e.target.dataset.page || e.target.closest('[data-page]').dataset.page;
                    navigateTo(page);
                });
            });
            
            // Logout button
            const logoutBtn = document.querySelector('.logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', () => {
                    currentUser = null;
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                    showNotification('üëã Ba≈üarƒ±yla √ßƒ±kƒ±≈ü yaptƒ±nƒ±z.');
                    setTimeout(() => navigateTo('login'), 1000);
                });
            }
        }

        // Uygulama ba≈ülatma
        function initApp() {
            // Saklanan kullanƒ±cƒ±yƒ± kontrol et
            const savedUser = localStorage.getItem('user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
            }
            
            // URL'den sayfa al
            const hash = window.location.hash.slice(1);
            const initialPage = hash || (currentUser ? 'home' : 'login');
            
            navigateTo(initialPage);
            hideLoadingScreen();
        }

        // Browser navigation
        window.addEventListener('hashchange', () => {
            const page = window.location.hash.slice(1) || (currentUser ? 'home' : 'login');
            navigateTo(page);
        });

        // Klavye kƒ±sayollarƒ±
        document.addEventListener('keydown', (e) => {
            if (!currentUser) return;
            
            if (e.altKey) {
                switch(e.key) {
                    case 'h':
                        e.preventDefault();
                        navigateTo('home');
                        break;
                    case 'c':
                        e.preventDefault();
                        navigateTo('create');
                        break;
                    case 'p':
                        e.preventDefault();
                        navigateTo('profile');
                        break;
                    case 'm':
                        e.preventDefault();
                        navigateTo('map');
                        break;
                }
            }
        });

        // Service worker i√ßin offline destek (isteƒüe baƒülƒ±)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }

        // Global fonksiyonlar (onclick i√ßin)
        window.joinEvent = joinEvent;
        window.leaveEvent = leaveEvent;
        window.showEventDetails = showEventDetails;

        // Uygulamayƒ± ba≈ülat
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>