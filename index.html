<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find My Team</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="src/style.css">
</head>
<body>
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h3>Spor ArkadaÅŸÄ± YÃ¼kleniyor...</h3>
        </div>
    </div>

    <div class="bg-animation">
        <div class="floating-shape"></div>
        <div class="floating-shape"></div>
        <div class="floating-shape"></div>
        <div class="floating-shape"></div>
    </div>

    <div id="app"></div>

    <script>
        // API URL (Backend baÄŸlantÄ±sÄ± iÃ§in)
        const API_URL = 'https://localhost:7001/api';

        // Sayfa ÅŸablonlarÄ±
        const pages = {
            login: `
                <div class="auth-container">
                    <div class="auth-box glass">
                        <div class="auth-avatar">
                            <i class="fas fa-running"></i>
                        </div>
                        <div class="auth-tabs" id="authTabs">
                            <button class="tab-btn active" data-tab="login">
                                <i class="fas fa-sign-in-alt"></i> GiriÅŸ Yap
                            </button>
                            <button class="tab-btn" data-tab="register">
                                <i class="fas fa-user-plus"></i> KayÄ±t Ol
                            </button>
                        </div>
                        <form id="loginForm">
                            <div class="form-group">
                                <input type="email" class="form-input" placeholder="âœ‰ï¸ E-posta adresiniz" required>
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-input" placeholder="ğŸ”’ Åifreniz" required>
                            </div>
                            <button type="submit" class="submit-btn">
                                <span class="btn-text">
                                    <i class="fas fa-sign-in-alt"></i> GiriÅŸ Yap
                                </span>
                            </button>
                        </form>
                    </div>
                </div>
            `,

            register: `
                <div class="auth-container">
                    <div class="auth-box glass">
                        <div class="auth-avatar">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <div class="auth-tabs register-active" id="authTabs">
                            <button class="tab-btn" data-tab="login">
                                <i class="fas fa-sign-in-alt"></i> GiriÅŸ Yap
                            </button>
                            <button class="tab-btn active" data-tab="register">
                                <i class="fas fa-user-plus"></i> KayÄ±t Ol
                            </button>
                        </div>
                        <form id="registerForm">
                            <div class="form-group">
                                <input type="text" class="form-input" placeholder="ğŸ‘¤ Ad Soyad" required>
                            </div>
                            <div class="form-group">
                                <input type="email" class="form-input" placeholder="âœ‰ï¸ E-posta adresiniz" required>
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-input" placeholder="ğŸ”’ Åifre" required>
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-input" placeholder="ğŸ”’ Åifre Tekrar" required>
                            </div>
                            <button type="submit" class="submit-btn">
                                <span class="btn-text">
                                    <i class="fas fa-user-plus"></i> KayÄ±t Ol
                                </span>
                            </button>
                        </form>
                    </div>
                </div>
            `,

            home: `
                <header class="app-header">
                    <div class="header-content">
                        <a href="#" class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <span>Spor ArkadaÅŸÄ±</span>
                        </a>
                        <nav class="nav-menu">
                            <button class="nav-btn active" data-page="home">
                                <i class="fas fa-home"></i> Ana Sayfa
                            </button>
                            <button class="nav-btn" data-page="create">
                                <i class="fas fa-plus-circle"></i> Etkinlik OluÅŸtur
                            </button>
                            <button class="nav-btn" data-page="map">
                                <i class="fas fa-map-marker-alt"></i> Harita
                            </button>
                            <button class="nav-btn" data-page="profile">
                                <i class="fas fa-user"></i> Profil
                            </button>
                            <button class="nav-btn logout-btn">
                                <i class="fas fa-sign-out-alt"></i> Ã‡Ä±kÄ±ÅŸ
                            </button>
                        </nav>
                    </div>
                </header>
                
                <main class="main-content">
                    <section class="hero">
                        <h1><i class="fas fa-fire"></i> Find My Team!</h1>
                        <p>Ã‡evrendeki sporcularla tanÄ±ÅŸ, etkinliklere katÄ±l ve aktif yaÅŸamÄ±nÄ±n tadÄ±nÄ± Ã§Ä±kar!</p>
                        <div class="hero-stats">
                            <div class="stat-item">
                                <span class="stat-number" id="activeEvents">0</span>
                                <span class="stat-label">Aktif Etkinlik</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="totalUsers">0</span>
                                <span class="stat-label">KayÄ±tlÄ± KullanÄ±cÄ±</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="sportsCount">8</span>
                                <span class="stat-label">Spor DalÄ±</span>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h2 class="section-title">ğŸ”¥ PopÃ¼ler Etkinlikler</h2>
                        <div class="events-grid" id="eventsGrid">
                            <!-- Etkinlikler buraya yÃ¼klenecek -->
                        </div>
                    </section>
                </main>
            `,

            create: `
                <header class="app-header">
                    <div class="header-content">
                        <a href="#" class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <span>Spor ArkadaÅŸÄ±</span>
                        </a>
                        <nav class="nav-menu">
                            <button class="nav-btn" data-page="home">
                                <i class="fas fa-home"></i> Ana Sayfa
                            </button>
                            <button class="nav-btn active" data-page="create">
                                <i class="fas fa-plus-circle"></i> Etkinlik OluÅŸtur
                            </button>
                            <button class="nav-btn" data-page="map">
                                <i class="fas fa-map-marker-alt"></i> Harita
                            </button>
                            <button class="nav-btn" data-page="profile">
                                <i class="fas fa-user"></i> Profil
                            </button>
                            <button class="nav-btn logout-btn">
                                <i class="fas fa-sign-out-alt"></i> Ã‡Ä±kÄ±ÅŸ
                            </button>
                        </nav>
                    </div>
                </header>
                
                <main class="main-content">
                    <section>
                        <h2 class="section-title"><i class="fas fa-magic"></i> Yeni Etkinlik OluÅŸtur</h2>
                        <div class="create-form">
                            <form id="createEventForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <select class="form-select" name="sportType" required>
                                            <option value="">ğŸƒâ€â™‚ï¸ Spor TÃ¼rÃ¼ SeÃ§in</option>
                                            <option value="football">âš½ Futbol</option>
                                            <option value="basketball">ğŸ€ Basketbol</option>
                                            <option value="volleyball">ğŸ Voleybol</option>
                                            <option value="tennis">ğŸ¾ Tenis</option>
                                            <option value="running">ğŸƒâ€â™‚ï¸ KoÅŸu</option>
                                            <option value="cycling">ğŸš´â€â™‚ï¸ Bisiklet</option>
                                            <option value="swimming">ğŸŠâ€â™‚ï¸ YÃ¼zme</option>
                                            <option value="badminton">ğŸ¸ Badminton</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" class="form-input" name="title" placeholder="ğŸ† Etkinlik AdÄ±" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="text" class="form-input" name="location" placeholder="ğŸ“ Konum (Ã¶rn: AtatÃ¼rk ParkÄ±)" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="datetime-local" class="form-input" name="eventDate" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="number" class="form-input" name="maxParticipants" placeholder="ğŸ‘¥ Maksimum KatÄ±lÄ±mcÄ±" min="2" max="50" required>
                                    </div>
                                    <div class="form-group">
                                        <select class="form-select" name="skillLevel" required>
                                            <option value="">ğŸ“Š Seviye SeÃ§in</option>
                                            <option value="beginner">ğŸŒ± BaÅŸlangÄ±Ã§</option>
                                            <option value="intermediate">â­ Orta</option>
                                            <option value="advanced">ğŸ† Ä°leri</option>
                                            <option value="mixed">ğŸ¯ Karma</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <textarea class="form-textarea" name="description" placeholder="ğŸ“ Etkinlik aÃ§Ä±klamasÄ± (isteÄŸe baÄŸlÄ±)"></textarea>
                                </div>
                                
                                <button type="submit" class="submit-btn">
                                    <span class="btn-text">
                                        <i class="fas fa-rocket"></i> EtkinliÄŸi OluÅŸtur
                                    </span>
                                </button>
                            </form>
                        </div>
                    </section>
                </main>
            `,

            map: `
                <header class="app-header">
                    <div class="header-content">
                        <a href="#" class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <span>Spor ArkadaÅŸÄ±</span>
                        </a>
                        <nav class="nav-menu">
                            <button class="nav-btn" data-page="home">
                                <i class="fas fa-home"></i> Ana Sayfa
                            </button>
                            <button class="nav-btn" data-page="create">
                                <i class="fas fa-plus-circle"></i> Etkinlik OluÅŸtur
                            </button>
                            <button class="nav-btn active" data-page="map">
                                <i class="fas fa-map-marker-alt"></i> Harita
                            </button>
                            <button class="nav-btn" data-page="profile">
                                <i class="fas fa-user"></i> Profil
                            </button>
                            <button class="nav-btn logout-btn">
                                <i class="fas fa-sign-out-alt"></i> Ã‡Ä±kÄ±ÅŸ
                            </button>
                        </nav>
                    </div>
                </header>
                
                <main class="main-content">
                    <section>
                        <h2 class="section-title"><i class="fas fa-globe-americas"></i> Etkinlik HaritasÄ±</h2>
                        <div class="map-container">
                            <div class="map-placeholder">
                                <i class="fas fa-map-marked-alt"></i>
                                <h3>Harita Entegrasyonu</h3>
                                <p>Google Maps API ile etkinlikleri harita Ã¼zerinde gÃ¶rÃ¼ntÃ¼leyebileceksiniz.</p>
                                <p>YakÄ±nda aktif olacak!</p>
                            </div>
                        </div>
                    </section>
                </main>
            `,

            profile: `
                <header class="app-header">
                    <div class="header-content">
                        <a href="#" class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <span>Spor ArkadaÅŸÄ±</span>
                        </a>
                        <nav class="nav-menu">
                            <button class="nav-btn" data-page="home">
                                <i class="fas fa-home"></i> Ana Sayfa
                            </button>
                            <button class="nav-btn" data-page="create">
                                <i class="fas fa-plus-circle"></i> Etkinlik OluÅŸtur
                            </button>
                            <button class="nav-btn" data-page="map">
                                <i class="fas fa-map-marker-alt"></i> Harita
                            </button>
                            <button class="nav-btn active" data-page="profile">
                                <i class="fas fa-user"></i> Profil
                            </button>
                            <button class="nav-btn logout-btn">
                                <i class="fas fa-sign-out-alt"></i> Ã‡Ä±kÄ±ÅŸ
                            </button>
                        </nav>
                    </div>
                </header>
                
                <main class="main-content">
                    <div class="profile-container">
                        <section class="profile-header">
                            <div class="profile-avatar">
                                <i class="fas fa-user-athlete"></i>
                            </div>
                            <h2 class="profile-name" id="profileName">KullanÄ±cÄ±</h2>
                            <p class="profile-email" id="profileEmail">email@example.com</p>
                        </section>

                        <section>
                            <h2 class="section-title"><i class="fas fa-chart-line"></i> Ä°statistiklerim</h2>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-calendar-check"></i>
                                    </div>
                                    <div class="stat-value" id="joinedEvents">0</div>
                                    <div class="stat-description">KatÄ±ldÄ±ÄŸÄ±m Etkinlik</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-plus-circle"></i>
                                    </div>
                                    <div class="stat-value" id="createdEvents">0</div>
                                    <div class="stat-description">OluÅŸturduÄŸum Etkinlik</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <div class="stat-value" id="completedEvents">0</div>
                                    <div class="stat-description">Tamamlanan Etkinlik</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <div class="stat-value" id="sportFriends">0</div>
                                    <div class="stat-description">Spor ArkadaÅŸÄ±</div>
                                </div>
                            </div>
                        </section>
                    </div>
                </main>
            `
        };

        // Uygulama durumu
        let currentUser = null;
        let events = [];

        // Spor ikonu mapping
        const sportIcons = {
            football: 'âš½',
            basketball: 'ğŸ€',
            volleyball: 'ğŸ',
            tennis: 'ğŸ¾',
            running: 'ğŸƒâ€â™‚ï¸',
            cycling: 'ğŸš´â€â™‚ï¸',
            swimming: 'ğŸŠâ€â™‚ï¸',
            badminton: 'ğŸ¸'
        };

        // Seviye mapping
        const skillLevels = {
            beginner: 'ğŸŒ± BaÅŸlangÄ±Ã§',
            intermediate: 'â­ Orta',
            advanced: 'ğŸ† Ä°leri',
            mixed: 'ğŸ¯ Karma'
        };

        // API Ã§aÄŸrÄ±larÄ±
        const api = {
            async login(email, password) {
                try {
                    const response = await fetch(`${API_URL}/auth/login`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ email, password })
                    });
                    
                    if (!response.ok) {
                        throw new Error('GiriÅŸ baÅŸarÄ±sÄ±z');
                    }
                    
                    return await response.json();
                } catch (error) {
                    // GeÃ§ici olarak mock data dÃ¶ndÃ¼r
                    return {
                        success: true,
                        user: {
                            id: 1,
                            name: 'Ahmet YÄ±lmaz',
                            email: email
                        },
                        token: 'mock-token'
                    };
                }
            },

            async register(userData) {
                try {
                    const response = await fetch(`${API_URL}/auth/register`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(userData)
                    });
                    
                    if (!response.ok) {
                        throw new Error('KayÄ±t baÅŸarÄ±sÄ±z');
                    }
                    
                    return await response.json();
                } catch (error) {
                    // GeÃ§ici olarak mock data dÃ¶ndÃ¼r
                    return {
                        success: true,
                        message: 'KayÄ±t baÅŸarÄ±lÄ±'
                    };
                }
            },

            async getEvents() {
                try {
                    const response = await fetch(`${API_URL}/events`);
                    if (!response.ok) {
                        throw new Error('Etkinlikler yÃ¼klenemedi');
                    }
                    return await response.json();
                } catch (error) {
                    // Mock events data
                    return [
                        {
                            id: 1,
                            title: '5vs5 Futbol MaÃ§Ä±',
                            sportType: 'football',
                            location: 'AtatÃ¼rk ParkÄ±',
                            eventDate: new Date(Date.now() + 2 * 60 * 60 * 1000).toISOString(),
                            maxParticipants: 10,
                            currentParticipants: 6,
                            skillLevel: 'intermediate',
                            description: 'EÄŸlenceli futbol maÃ§Ä± iÃ§in katÄ±lÄ±mcÄ±lar bekliyoruz!',
                            creatorName: 'Mehmet Ã–zkan'
                        },
                        {
                            id: 2,
                            title: 'Basketbol TurnuvasÄ±',
                            sportType: 'basketball',
                            location: 'Spor Salonu',
                            eventDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
                            maxParticipants: 8,
                            currentParticipants: 4,
                            skillLevel: 'advanced',
                            description: 'Basketbol severler iÃ§in turnuva organizasyonu',
                            creatorName: 'AyÅŸe Demir'
                        },
                        {
                            id: 3,
                            title: 'Tenis Partneri ArÄ±yorum',
                            sportType: 'tennis',
                            location: 'Tenis KulÃ¼bÃ¼',
                            eventDate: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString(),
                            maxParticipants: 2,
                            currentParticipants: 1,
                            skillLevel: 'beginner',
                            description: 'Yeni baÅŸlayan tenis oyuncusu partner arÄ±yor',
                            creatorName: 'Ali YÄ±ldÄ±z'
                        },
                        {
                            id: 4,
                            title: 'Sabah KoÅŸusu Grubu',
                            sportType: 'running',
                            location: 'MaÃ§ka ParkÄ±',
                            eventDate: new Date(Date.now() + 12 * 60 * 60 * 1000).toISOString(),
                            maxParticipants: 15,
                            currentParticipants: 8,
                            skillLevel: 'mixed',
                            description: 'Her seviyeden koÅŸucu hoÅŸ geldin!',
                            creatorName: 'Fatma Kaya'
                        }
                    ];
                }
            },

            async createEvent(eventData) {
                try {
                    const response = await fetch(`${API_URL}/events`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${localStorage.getItem('token')}`
                        },
                        body: JSON.stringify(eventData)
                    });
                    
                    if (!response.ok) {
                        throw new Error('Etkinlik oluÅŸturulamadÄ±');
                    }
                    
                    return await response.json();
                } catch (error) {
                    // Mock success
                    return {
                        success: true,
                        message: 'Etkinlik baÅŸarÄ±yla oluÅŸturuldu',
                        event: { id: Date.now(), ...eventData }
                    };
                }
            },

            async joinEvent(eventId) {
                try {
                    const response = await fetch(`${API_URL}/events/${eventId}/join`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('token')}`
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error('EtkinliÄŸe katÄ±lÄ±namadÄ±');
                    }
                    
                    return await response.json();
                } catch (error) {
                    // Mock success
                    return {
                        success: true,
                        message: 'EtkinliÄŸe baÅŸarÄ±yla katÄ±ldÄ±nÄ±z'
                    };
                }
            }
        };

        // Bildirim sistemi
        function showNotification(message, type = 'success') {
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();

            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-triangle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        // Loading ekranÄ±
        function hideLoadingScreen() {
            const loadingScreen = document.getElementById('loadingScreen');
            setTimeout(() => {
                loadingScreen.classList.add('hidden');
                setTimeout(() => loadingScreen.remove(), 500);
            }, 1000);
        }

        // Sayfa navigasyonu
        function navigateTo(page) {
            const app = document.getElementById('app');
            
            if (!currentUser && !['login', 'register'].includes(page)) {
                page = 'login';
            }
            
            app.innerHTML = pages[page] || pages.login;
            setupPageEvents(page);
            window.location.hash = page;
        }

        // Sayfa event'leri
        function setupPageEvents(page) {
            switch(page) {
                case 'login':
                    setupAuthEvents();
                    break;
                case 'register':
                    setupAuthEvents();
                    break;
                case 'home':
                    setupHomeEvents();
                    loadEvents();
                    break;
                case 'create':
                    setupCreateEvents();
                    break;
                case 'profile':
                    setupProfileEvents();
                    break;
            }
            
            setupNavigationEvents();
        }

        // Auth sayfasÄ± event'leri
        function setupAuthEvents() {
            // Tab switching
            document.querySelectorAll('[data-tab]').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    navigateTo(e.target.dataset.tab);
                });
            });

            // Login form
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const submitBtn = loginForm.querySelector('button[type="submit"]');
                    submitBtn.classList.add('btn-loading');
                    
                    const formData = new FormData(loginForm);
                    const email = formData.get('email') || loginForm.querySelector('input[type="email"]').value;
                    const password = formData.get('password') || loginForm.querySelector('input[type="password"]').value;
                    
                    try {
                        const response = await api.login(email, password);
                        
                        if (response.success) {
                            currentUser = response.user;
                            localStorage.setItem('token', response.token);
                            localStorage.setItem('user', JSON.stringify(response.user));
                            
                            showNotification('ğŸ‰ HoÅŸ geldiniz! GiriÅŸ baÅŸarÄ±lÄ±.');
                            setTimeout(() => navigateTo('home'), 1000);
                        }
                    } catch (error) {
                        showNotification('âŒ GiriÅŸ yapÄ±lamadÄ±. LÃ¼tfen bilgilerinizi kontrol edin.', 'error');
                    } finally {
                        submitBtn.classList.remove('btn-loading');
                    }
                });
            }

            // Register form
            const registerForm = document.getElementById('registerForm');
            if (registerForm) {
                registerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const submitBtn = registerForm.querySelector('button[type="submit"]');
                    const inputs = registerForm.querySelectorAll('input');
                    const passwords = registerForm.querySelectorAll('input[type="password"]');
                    
                    // Åifre kontrolÃ¼
                    if (passwords[0].value !== passwords[1].value) {
                        showNotification('âŒ Åifreler eÅŸleÅŸmiyor!', 'error');
                        return;
                    }
                    
                    if (passwords[0].value.length < 6) {
                        showNotification('âŒ Åifre en az 6 karakter olmalÄ±!', 'error');
                        return;
                    }
                    
                    submitBtn.classList.add('btn-loading');
                    
                    const userData = {
                        name: inputs[0].value,
                        email: inputs[1].value,
                        password: inputs[2].value
                    };
                    
                    try {
                        const response = await api.register(userData);
                        
                        if (response.success) {
                            showNotification('âœ… KayÄ±t baÅŸarÄ±lÄ±! Åimdi giriÅŸ yapabilirsiniz.');
                            setTimeout(() => navigateTo('login'), 1500);
                        }
                    } catch (error) {
                        showNotification('âŒ KayÄ±t iÅŸlemi baÅŸarÄ±sÄ±z. LÃ¼tfen tekrar deneyin.', 'error');
                    } finally {
                        submitBtn.classList.remove('btn-loading');
                    }
                });
            }
        }

        // Ana sayfa event'leri
        function setupHomeEvents() {
            // Ä°statistikleri gÃ¼ncelle
            setTimeout(() => {
                document.getElementById('activeEvents').textContent = '12';
                document.getElementById('totalUsers').textContent = '247';
            }, 1000);
        }

        // Etkinlikleri yÃ¼kle
        async function loadEvents() {
            try {
                events = await api.getEvents();
                renderEvents(events);
            } catch (error) {
                showNotification('âŒ Etkinlikler yÃ¼klenemedi.', 'error');
            }
        }

        // Etkinlikleri render et
        function renderEvents(eventsData) {
            const eventsGrid = document.getElementById('eventsGrid');
            if (!eventsGrid) return;

            eventsGrid.innerHTML = eventsData.map(event => {
                const eventDate = new Date(event.eventDate);
                const formattedDate = eventDate.toLocaleDateString('tr-TR', {
                    day: 'numeric',
                    month: 'long',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                return `
                    <div class="event-card" data-event-id="${event.id}">
                        <div class="event-header">
                            <div class="event-icon">
                                ${sportIcons[event.sportType] || 'ğŸƒâ€â™‚ï¸'}
                            </div>
                            <h3 class="event-title">${event.title}</h3>
                        </div>
                        
                        <div class="event-details">
                            <div class="event-detail">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${event.location}</span>
                            </div>
                            <div class="event-detail">
                                <i class="fas fa-clock"></i>
                                <span>${formattedDate}</span>
                            </div>
                            <div class="event-detail">
                                <i class="fas fa-users"></i>
                                <span>${event.currentParticipants}/${event.maxParticipants} kiÅŸi</span>
                            </div>
                            <div class="event-detail">
                                <i class="fas fa-chart-bar"></i>
                                <span>${skillLevels[event.skillLevel]}</span>
                            </div>
                            <div class="event-detail">
                                <i class="fas fa-user-circle"></i>
                                <span>OrganizatÃ¶r: ${event.creatorName}</span>
                            </div>
                        </div>
                        
                        <div class="event-actions">
                            <button class="action-btn join-btn" onclick="joinEvent(${event.id})">
                                <i class="fas fa-hand-rock"></i> KatÄ±l
                            </button>
                            <button class="action-btn details-btn" onclick="showEventDetails(${event.id})">
                                <i class="fas fa-info-circle"></i> Detay
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // EtkinliÄŸe katÄ±l
        async function joinEvent(eventId) {
            try {
                const response = await api.joinEvent(eventId);
                if (response.success) {
                    showNotification('ğŸ‰ EtkinliÄŸe baÅŸarÄ±yla katÄ±ldÄ±nÄ±z!');
                    // UI gÃ¼ncelle
                    const eventCard = document.querySelector(`[data-event-id="${eventId}"]`);
                    const joinBtn = eventCard.querySelector('.join-btn');
                    joinBtn.innerHTML = '<i class="fas fa-times"></i> AyrÄ±l';
                    joinBtn.classList.add('joined');
                    joinBtn.onclick = () => leaveEvent(eventId);
                }
            } catch (error) {
                showNotification('âŒ EtkinliÄŸe katÄ±lÄ±namadÄ±.', 'error');
            }
        }

        // Etkinlikten ayrÄ±l
        async function leaveEvent(eventId) {
            try {
                showNotification('ğŸ‘‹ Etkinlikten ayrÄ±ldÄ±nÄ±z.');
                // UI gÃ¼ncelle
                const eventCard = document.querySelector(`[data-event-id="${eventId}"]`);
                const joinBtn = eventCard.querySelector('.join-btn');
                joinBtn.innerHTML = '<i class="fas fa-hand-rock"></i> KatÄ±l';
                joinBtn.classList.remove('joined');
                joinBtn.onclick = () => joinEvent(eventId);
            } catch (error) {
                showNotification('âŒ Ä°ÅŸlem baÅŸarÄ±sÄ±z.', 'error');
            }
        }

        // Etkinlik detaylarÄ±nÄ± gÃ¶ster
        function showEventDetails(eventId) {
            const event = events.find(e => e.id === eventId);
            if (event) {
                alert(`
Etkinlik: ${event.title}
AÃ§Ä±klama: ${event.description || 'AÃ§Ä±klama bulunmuyor.'}
Konum: ${event.location}
Tarih: ${new Date(event.eventDate).toLocaleString('tr-TR')}
Seviye: ${skillLevels[event.skillLevel]}
KatÄ±lÄ±mcÄ±lar: ${event.currentParticipants}/${event.maxParticipants}
OrganizatÃ¶r: ${event.creatorName}
                `);
            }
        }

        // Etkinlik oluÅŸturma event'leri
        function setupCreateEvents() {
            const createForm = document.getElementById('createEventForm');
            if (createForm) {
                createForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const submitBtn = createForm.querySelector('button[type="submit"]');
                    submitBtn.classList.add('btn-loading');
                    
                    const formData = new FormData(createForm);
                    const eventData = {
                        title: formData.get('title'),
                        sportType: formData.get('sportType'),
                        location: formData.get('location'),
                        eventDate: formData.get('eventDate'),
                        maxParticipants: parseInt(formData.get('maxParticipants')),
                        skillLevel: formData.get('skillLevel'),
                        description: formData.get('description')
                    };
                    
                    try {
                        const response = await api.createEvent(eventData);
                        
                        if (response.success) {
                            showNotification('ğŸš€ Etkinlik baÅŸarÄ±yla oluÅŸturuldu!');
                            setTimeout(() => navigateTo('home'), 1500);
                        }
                    } catch (error) {
                        showNotification('âŒ Etkinlik oluÅŸturulamadÄ±.', 'error');
                    } finally {
                        submitBtn.classList.remove('btn-loading');
                    }
                });
            }
        }

        // Profil event'leri
        function setupProfileEvents() {
            if (currentUser) {
                document.getElementById('profileName').textContent = currentUser.name;
                document.getElementById('profileEmail').textContent = currentUser.email;
                
                // Mock istatistikler
                setTimeout(() => {
                    document.getElementById('joinedEvents').textContent = '5';
                    document.getElementById('createdEvents').textContent = '2';
                    document.getElementById('completedEvents').textContent = '3';
                    document.getElementById('sportFriends').textContent = '12';
                }, 500);
            }
        }

        // Navigation event'leri
        function setupNavigationEvents() {
            // Nav button'larÄ±
            document.querySelectorAll('[data-page]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const page = e.target.dataset.page || e.target.closest('[data-page]').dataset.page;
                    navigateTo(page);
                });
            });
            
            // Logout button
            const logoutBtn = document.querySelector('.logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', () => {
                    currentUser = null;
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                    showNotification('ğŸ‘‹ BaÅŸarÄ±yla Ã§Ä±kÄ±ÅŸ yaptÄ±nÄ±z.');
                    setTimeout(() => navigateTo('login'), 1000);
                });
            }
        }

        // Uygulama baÅŸlatma
        function initApp() {
            // Saklanan kullanÄ±cÄ±yÄ± kontrol et
            const savedUser = localStorage.getItem('user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
            }
            
            // URL'den sayfa al
            const hash = window.location.hash.slice(1);
            const initialPage = hash || (currentUser ? 'home' : 'login');
            
            navigateTo(initialPage);
            hideLoadingScreen();
        }

        // Browser navigation
        window.addEventListener('hashchange', () => {
            const page = window.location.hash.slice(1) || (currentUser ? 'home' : 'login');
            navigateTo(page);
        });

        // Klavye kÄ±sayollarÄ±
        document.addEventListener('keydown', (e) => {
            if (!currentUser) return;
            
            if (e.altKey) {
                switch(e.key) {
                    case 'h':
                        e.preventDefault();
                        navigateTo('home');
                        break;
                    case 'c':
                        e.preventDefault();
                        navigateTo('create');
                        break;
                    case 'p':
                        e.preventDefault();
                        navigateTo('profile');
                        break;
                    case 'm':
                        e.preventDefault();
                        navigateTo('map');
                        break;
                }
            }
        });

        // Service worker iÃ§in offline destek (isteÄŸe baÄŸlÄ±)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }

        // Global fonksiyonlar (onclick iÃ§in)
        window.joinEvent = joinEvent;
        window.leaveEvent = leaveEvent;
        window.showEventDetails = showEventDetails;

        // UygulamayÄ± baÅŸlat
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>